  For $z\in\R$ we define the function
  \begin{align*}
    f_z
    \ 
    :
    \ 
      \left\{ 0,1 \right\}
      \times
      \mathcal{X}
      \times
      \mathcal{Y}
    &
    \ 
    \to
    \ 
    \R
    \\
      (t,x,y)
    &
      \ 
      \mapsto
      \ 
      t
      \left( 
        \mathbf{1}
        _{\left\{  y\,\le\,z \right\}}
        -
        F_{Y(1)}(z|x)
      \right)
      \,,
  \end{align*}
  \begin{lemma}
    \label{lem:f_z}
    It holds
    $f_z(T,X,Y(T))\in L^1(\P)$
    and 
    $f_z(T,X,Y(T))\perp D_N$
    for all $z\in\R$.
    If also Assumption~\ref{aa:assumption:treatment_str_ign} holds,
    then 
    for all $z\in\R$
    \begin{gather*}
      \E
      \left[
        f_z
        \left( 
          T,
          X,
          Y(T)
        \right)
        \,
        |
        \,
        X
      \right]
      \ 
      =
      \ 
      0
      \qquad
      \text{almost surely.}
    \end{gather*}
  \end{lemma}
  \begin{proof}
    Since $f_z$ is bounded by 1,
    it holds
    $f_z(T,X,Y(T))\in L^1(\P)$.
    Since
    \begin{gather*}
    (T,X,Y(T))
    \ 
    \perp 
    \ 
    D_N
    \ 
    =
    \ 
    (T_i,X_i)_{i\in \left\{ 1,\ldots,N \right\}}
    \end{gather*}
    it holds
    $f_z(T,X,Y(T))\perp D_N$
    for all $z\in\R$.
    For the third statement, note that
    \begin{align*}
      \E
      \left[
        f_z
        \left( 
          T,
          X,
          Y(T)
        \right)
        \,
        |
        \,
        X
      \right]
      &
      \ 
      =
      \ 
      \E
      \left[
      T
      \left( 
        \mathbf{1}
        _{\left\{  Y(T)\,\le\,z \right\}}
        -
        F_{Y(1)}(z|X)
      \right)
        \,
        |
        \,
        X
      \right]
      \\
      &
      \ 
      =
      \ 
      \E
      \left[
        \mathbf{1}
        _{\left\{  Y(1)\,\le\,z \right\}}
        -
        F_{Y(1)}(z|X)
        \,
        |
        \,
        X
        ,
        T=1
      \right]
      \pi(X)
      \\
      &
      \ 
      =
      \ 
      \left( 
      \E
      \left[
        \mathbf{1}
        _{\left\{  Y(1)\,\le\,z \right\}}
        \,
        |
        \,
        X
      \right]
      \ 
        -
      \ 
        F_{Y(1)}(z|X)
      \right)
      \pi(X)
      \\
      &
      \ 
      =
      \ 
      0
      \qquad
      \text{almost surely.}
    \end{align*}
    The third equality is due to Assumption~\ref{aa:assumption:treatment_str_ign}.
  \end{proof}
  Next we define the function classes
  \begin{gather}
    \label{F_g}
    \begin{split}
    \mathcal{F}
    &
    \ 
    :=
    \ 
    \left\{ 
      f_z
      \ 
      |
      \ 
      z\in\R\ 
    \right\}
    \\
    \mathcal{G}
    &
    \ 
    :=
    \ 
    \left\{ 
      \frac{f_z}{\pi(\cdot)}
      +
      F_{Y(1)}(z|\cdot)
      -
      F_{Y(1)}(z)
      \ 
      \colon
      \ 
      z\in\R\ 
    \right\}
    \,.
    \end{split}
  \end{gather}
The next lemma provides bracketing numbers for these classes.
\newpage
\begin{lemma}
  \label{aa:mean:l:br}
  The function class $\mathcal{F}$ and $\mathcal{G}$ defined in \eqref{F_g} are measurable.
  Furthermore, 
  \begin{gather*}
    N_{[\,]}
    (
    \varepsilon
    ,
    \mathcal{F}, L^2(\P))
    \ 
    \lesssim
    \ 
    \left( 
      \frac{1}{\varepsilon}
    \right)^2
    \qquad
    \text{for all}
    \ 
    \varepsilon>0
    \,.
  \end{gather*}
  If $1/\pi(X)\in L^2(\P)$, it also holds 
  \begin{gather*}
    N_{[\,]}
    (
    \varepsilon
    ,
    \mathcal{G}, L^2(\P))
    \ 
    \lesssim
    \ 
    \left( 
    \frac{
      1+
    \norm{1/\pi(X)}_{ L^2(\P)}
    }
    {\varepsilon}
    \right)^4
    \qquad
    \text{for all}
    \ 
    \varepsilon>0
    \,.
  \end{gather*}
%  Furthermore, 
%  consider the function class
%  \begin{gather*}
%    \mathcal{G}
%    :=
%    \left\{ 
%      f_{1/\pi}^z
%      +
%        F_{Y(1)}(z|\cdot)
%        -
%        F_{Y(1)}(z)
%      \ 
%      |
%      \ 
%      z\in\R
%    \right\}
%    \,.
%  \end{gather*}
%  If $1/\pi(X)\in  L^2(\P)$
%  it holds
%  \begin{gather}
%    N_{[\,]}(\varepsilon,\mathcal{G}, L^2(\P))
%    \le
%    ??
%    \qquad
%    \text{for all}
%    \ 
%    \varepsilon>0
%    \,.
%  \end{gather}
\end{lemma}
\begin{proof}
  As in \cite[Example~19.6]{Vaart2000}
  we choose for
  $\varepsilon>0$ and $m\in\mathbb{N}$
  \begin{gather*}
  -\infty=z_0\ <\ z_1\ <\ \cdots\ <\ z_{m-1}\ <\ z_m=\infty
  \,
  \end{gather*}
  such that
  \begin{gather}
    \label{size_z}
    \P
    \left[ 
      Y(1)\in \left[ z_{l-1},z_l \right]\,
    \right]
    \ 
    \le
    \ 
    \varepsilon
    \qquad
    \text{for all}\ 
    l\in \left\{ 1,\ldots,m \right\}
  \end{gather}
  and $m \le 2/\varepsilon$.
  Next, we define $m$ brackets by
\begin{align*}
  \overline{f_l}
  (t,x,y)
  &
  \ 
  :=
  \ 
      t
      \left( 
        \mathbf{1}
        _{\left\{  y\,\le\,z_{l} \right\}}
        -
        F_{Y(1)}(z_{l-1}|x)
      \right)
      \,,
      \\
  \underline{f_l}
  (t,x,y)
  &
  \ 
  :=
  \ 
      t
      \left( 
        \mathbf{1}
        _{\left\{  y\,\le\,z_{l-1} \right\}}
        -
        F_{Y(1)}(z_l|x)
      \right)
      \,,
\end{align*}
for $l\in \left\{ 1,\ldots,m \right\}$.
These brackets cover $\mathcal{F}$.
Indeed,
\begin{gather*}
  \text{for all}\ 
  z\in\R
  \ 
  \text{there exists} \ 
l\in \left\{ 1,\ldots,m \right\}
\qquad 
\text{such that}\qquad
z_{l-1}
\ 
\le
\ 
z
\ 
\le
\ 
z_l
\,.
\end{gather*}
By the monotonicity of 
$
        \mathbf{1}
      _{\left\{  y\,\le\,(\cdot) \right\}}
$
and
$
        F_{Y(1)}(\cdot|x)
$
and the non-negativity of $T$ it follows
\begin{gather*}
  \text{for all}\ 
  z\in\R
  \ 
  \text{there exists} \ 
l\in \left\{ 1,\ldots,m \right\}
\qquad 
\text{such that}\qquad
  \underline{f_l}
  \ 
  \le
  \ 
  f_z
  \ 
  \le
  \ 
  \overline{f_l}
  \,.
\end{gather*}
Thus, the $m$ brackets 
$
[
  \underline{f_l}
  ,
  \overline{f_l}
]
$
cover $\mathcal{F}$.

Let's calculate the size of the brackets.
It holds
\begin{align*}
  &
\E
\left[ 
      T
      \cdot
      \left( 
        \mathbf{1}
        _{\left\{  Y(T)\,\le\,z_{l} \right\}}
        -
        F_{Y(1)}(z_{l-1}|X)
        \ 
        -
        \ 
        \mathbf{1}
        _{\left\{  Y(T)\,\le\,z_{l-1} \right\}}
        +
        F_{Y(1)}(z_{l}|X)
      \right)
      \,
\right]
\\
  &
  \ 
=
  \ 
\E
\left[ 
      T
      \cdot
      \left( 
        \mathbf{1}
        _{\left\{
        Y(T)
        \,
        \in 
        \,
    [z_{l-1},z_l]
\right\}}
\ 
        +
\ 
        \P
        \left[ 
          Y(1)
          \in
    [z_{l-1},z_l]
        \,
    |
        \,
    X
        \right]
      \right)
      \,
\right]
\\
  &
  \ 
\le
  \ 
\E
\left[ 
  \,
  \pi(X)
  \cdot
        \P
        \left[ 
          Y(1)
          \in
    [z_{l-1},z_l]
          \,
    |
          \,
    X
        \right]
          \ 
\right]
\ 
+
\ 
\varepsilon
\\
  &
  \ 
\le
  \ 
2
\,
\varepsilon
\,.
\end{align*}
We used \eqref{size_z}, $0\le T,\pi(X)\le 1$ and Lemma~\ref{ps_weights_lemma}.
It follows
\begin{align*}
  &
  \norm{
    \left( 
  \overline{f_l}
-
  \underline{f_l}
    \right)
  (T,X,Y(T))
}_
{ L^2(\P)}
\\
&
\ 
\lesssim
\ 
\E
\left[ 
  \,
      T
      \cdot
      \left( 
        \mathbf{1}
        _{\left\{
        Y(T)
        \,
        \in 
        \,
    [z_{l-1},z_l]
\right\}}
\ 
        +
\ 
        \P
        \left[ 
          Y(1)
          \in
    [z_{l-1},z_l]
        \,
    |
        \,
    X
        \right]
      \right)
      \,
   \right]^{1/2}
\ 
\lesssim
\ 
\varepsilon^{1/2}
\,.
\end{align*}
Since $m\le 2/\varepsilon$ it holds
  \begin{align*}
    N_{[\,]}
    \left(
\varepsilon^{1/2}
    ,
    \,
    \mathcal{F}\,,\, L^2(\P)
    \right)
    &
    \ 
    \lesssim
    \ 
    \frac{1}{\varepsilon}
    \intertext{and thus}
    N_{[\,]}
    (
    \varepsilon
    ,
    \mathcal{F}, L^2(\P))
    &
    \ 
    \lesssim
    \ 
    \left( 
      \frac{1}{\varepsilon}
    \right)^2
    \,.
  \end{align*}
  Next, we look at $\mathcal{G}$. To this end, we define 
  $m$ brackets by
 \begin{align*}
    \overline{g_l}
    (t,x,y)
    \ 
    :=
    \ 
    \frac{t}{\pi(x)}
    \left( 
      \mathbf{1}{\left\{  y\,\le\,z_{l} \right\}}
      -
      F_{Y(1)}(z_{l-1}|x)
    \right)
    \ 
    +
    \ 
    F_{Y(1)}(z_{l}|x)
-
F_{Y(1)}(z_{l-1})
\,,
\\
    \underline{g_l}
    (t,x,y)
    \ 
    :=
    \ 
    \frac{t}{\pi(x)}
    \left( 
      \mathbf{1}{\left\{  y\,\le\,z_{l-1} \right\}}
      -
      F_{Y(1)}(z_l|x)
    \right)
    \ 
    +
    \ 
    F_{Y(1)}(z_{l-1}|x)
-
      F_{Y(1)}(z_l)
\,,
  \end{align*}
  for $l\in \left\{ 1,\ldots,m \right\}$.
  With the same arguments as before, we see that these brackets cover $\mathcal{G}$.
  Let's calculate the size.
  It holds
  \begin{align*}
    &
    \norm{
      \frac{T}{\pi(X)}
      \left( 
      \mathbf{1}{
      \left\{ 
      Y(T)\in [z_{l-1},z_l] 
    \right\}
    }
      +
      \P
      \left[ 
      Y(1)\in [z_{l-1},z_l] 
      \,
      |
      \,
      X
      \right]
      \right)
    }_{ L^2(\P)}
    \\
    &
    \
    \lesssim
    \
    \left( 
      \E
      \left[ 
        \frac{1}{\pi(X)}
        \frac{T}{\pi(X)}
      \left( 
      \mathbf{1}{
      \left\{ 
      Y(T)\in [z_{l-1},z_l] 
    \right\}
    }
      +
      \P
      \left[ 
      Y(1)\in [z_{l-1},z_l] 
      \,
      |
      \,
      X
      \right]
      \right)
      \right]
    \right)
    ^{1/2}
    \\
    &
    \
    \lesssim
    \
    \left( 
      \E
      \left[ 
        \frac{1}{\pi(X)}
      \P
      \left[ 
      Y(1)\in [z_{l-1},z_l] 
      \,
      |
      \,
      X
      \right]
      \right]
    \right)
    ^{1/2}
    \\
    &
    \ 
    \lesssim
    \ 
    \left( 
      \norm{1/\pi(X)}_{ L^2(\P)}
      \sqrt{\varepsilon}
    \right)
    ^{1/2}
    \ 
    =
    \ 
    \varepsilon^{1/4}
    \norm{1/\pi(X)}_{ L^2(\P)}^{1/2}
  \end{align*}
  and
  \begin{align*}
     \norm{
      \P
      \left[ 
      Y(1)\in [z_{l-1},z_l] 
      \,
      |
      \,
      X
      \right]
      \ 
     + 
      \ 
      \P
      \left[ 
      Y(1)\in [z_{l-1},z_l] \,
      \right]
    }_{ L^2(\P)}
    \ 
    \lesssim
    \ 
    \varepsilon^{1/2}
    \,.
  \end{align*}
  Thus
  \begin{align*}
  \norm{
    \left( 
  \overline{g_l}
-
  \underline{g_l}
    \right)
  (T,X,Y(T))
}_
{ L^2(\P)}
    &
\ 
\lesssim
\ 
\varepsilon^{1/4}
\left( 
  1
  +
    \norm{1/\pi(X)}_{ L^2(\P)}^{1/2}
\right)
\\
    &
\ 
\lesssim
\ 
\varepsilon^{1/4}
\left( 
  1
  +
    \norm{1/\pi(X)}_{ L^2(\P)}
\right)
\,.
  \end{align*}
As before, it follows
\begin{gather*}
    N_{[\,]}
    (
    \varepsilon
    ,
    \mathcal{G}, L^2(\P))
    \ 
    \lesssim
    \ 
    \left( 
    \frac{
      1+
    \norm{1/\pi(X)}_{ L^2(\P)}
    }
    {\varepsilon}
    \right)^4
    \,.
\end{gather*}
\end{proof}

\begin{lemma}
  It holds
  $
    R_3
    \ 
    \overset{l^\infty(\R)}{\to}
    \ 
    0
  $.
\end{lemma}
\begin{proof}
Note that
\begin{align}
  \label{89763}
  \left| 
  R_3
  \right|
  &
  \
  \le
  \ 
  \omega
  \left( 
    (\varphi^{'})^{-1}
    ,
    \norm{(\rho^\dagger,\lambda_0^\dagger)}_2
  \right)
  \cdot
  \left( 
  \frac{1}{
  \sqrt{N}
  }
    \sum_{i=1}^{N} 
    T_i
    \cdot
    \left( 
    \mathbf{1}{\left\{ Y_i(T_i) \le z \right\}}
    \ 
    -
    \ 
  F_{Y(1)}(z|X_i)
  \right)
\right)_{z\in\R}
    \,
\end{align}
By Corollary~\ref{cor:2} and the uniform continuity of 
$
    (\varphi^{'})^{-1}
$ it follows 
\begin{align*}
  \omega
  \left( 
    (\varphi^{'})^{-1}
    ,
    \norm{(\rho^\dagger,\lambda_0^\dagger)}_2
  \right)
  \ 
  \overset{\P}{\to}
  \ 
  0
  \,.
\end{align*}
By Lemma~\ref{lem:f_z}
it holds 
$
\E \left[ f_z(T,X,Y(T)) \right]=0
$.
Thus
\begin{align*}
  \frac{1}{\sqrt{N}}
    \sum_{i=1}^{N} 
    T_i
    \cdot
    \left( 
    \mathbf{1}{\left\{ Y_i(T_i) \le z \right\}}
    \ 
    -
    \ 
  F_{Y(1)}(z|X_i)
    \right)
    \ 
    =
    \ 
    \G_N f_z
\end{align*}
Since $\mathcal{F}$ is $\P$-Donsker, by the Donsker Theorem
the process 
$
\left( 
\G_N f_z
\right)_{z\in\R}
$
converges in $l^\infty(\R)$.
Thus by Slutzky's Theorem, the upper bound in \eqref{89763} converges to 0 in $l^\infty(\R)$.
It follows the statement.
\end{proof}

