\begin{assumption}
  \begin{enumerate}[label={(\roman*)}]
    Assume that the map 
    $
      f: \R \to \overline{\R}
    $
    has the following properties.
    \item
      $
        f 
        \ 
        \text{is strictly convex.}
      $
    \item
      $
        f
        \ 
        \text{is lower-semicontinuous and continuously differentiable on}
        \ 
        \mathrm{int}(\mathrm{dom}(f))
        .
      $
    \item
      $
        \text{The derivative of}\ 
        f\ 
        \text{on}\ 
        \mathrm{int}(\mathrm{dom}(f))
        \ 
        \text{is a diffeomorphism.}
      $
    \item
      $
        \text{The Legendre transformation}
        \ 
        f^*
        \ 
        \text{of}\ 
        f
        \ 
        \text{is finite}
        .
      $
    \item
      $
        \text{The function}\
        x\mapsto xt - f(x)
        \ 
        \text{takes its supremum on}
        \ 
        \mathrm{int}(\mathrm{dom}(f))
        \ 
        \text{for all}
        \ 
        t\in \R.
      $
  \end{enumerate}
\end{assumption}

We consider the following optimization problem.
\begin{problem}
  \begin{gather*}
    \underset{w_1, \ldots, w_n \in \R}{\mathrm{minimize}}
    \qquad
    \sum_{i = 1}^{n} T_i f(w_i)
  \end{gather*}
subject to the constraints
\begin{gather*}
    w_i T_i \ge 0,
    \qquad 
    i = 1, \ldots, n,
    \\
  \sum_{ i = 1 }^{n}
    w_i T_i
  =
  1
  \\
    \left| 
      \sum_{i = 1}^{n} w_i T_i B_k(X_i)
      - 
      \frac{1}{n} \sum_{i = 1}^{n} B_k(X_i)
    \right|
    \le 
    \delta_k,
    \qquad
    k = 1, \ldots, K
\end{gather*}
\end{problem}
\pagebreak
~\begin{ftheorem}
  Under Assumption,
  the dual of the above Problem is the unconstrained optimization problem 
  \begin{gather*}
    \underset{\lambda \in \R^K}{\mathrm{minimize}}
    \qquad
    \frac{1}{n}
    \sum_{i = 1}^{n} 
    nT_i 
    f^*
    (
      \inner{B(X_i)}{\lambda}
    )
    -
    \inner{B(X_i)}{\lambda}
    +
    \inner{\delta}{\left| \lambda \right|}
    ,
  \end{gather*}
  where
  $
  t \mapsto
    f^*(t)
    =
    t\,(f^{'})^{-1}(t)
    -
    f
    \left( 
      (f^{'})^{-1}(t)
    \right)
  $
  is the Legendre transformation of $f$,
  $
    B(X_i)
    =
    \left[ 
      B_1(X_i)
      ,
      \ldots
      ,
      B_K(X_i)
    \right]
    ^\top
  $
  denotes the $K$ basis functions of the covariates 
  of unit $i\in \left\{ 1, \ldots, n \right\}$
  and
  $
    \left| \lambda \right|
    =
    \left[ 
      \left| \lambda_1 \right|
      ,
      \ldots
      ,
      \left| \lambda_K \right|
    \right]
    ^\top
    ,
  $
  where $\left| \,\cdot\, \right|$
  is the absolute value of a real-valued scalar.
  Moreover, if $\lambda^\dagger$
  is an optimal solution then
  \begin{gather}
    w_i^*
    =
    (f^{'})^{-1}
    (
      \inner{B(X_i)}{\lambda^\dagger}
    )
    ,
    \quad
    i\in \left\{ 1,\ldots, n \right\}
  \end{gather}
  are the unique optimal solutions to (P)
  .
\end{ftheorem}
\begin{proof}
  We prove the following Lemma at the end of the section.
  \begin{lemma}
    The dual of the optimization problem is
  \begin{gather*}
    \underset{\lambda \in \R^{2K}}{\mathrm{minimize}}
    \qquad
    \frac{1}{n}
    \sum_{i = 1}^{n} 
    nT_i 
    f^*
    (
    \inner{Q_{\bullet i}}{\lambda}
    )
    -
    \inner{Q_{\bullet i}}{\lambda}
    +
    \inner{d}{\lambda}
  \end{gather*}
  subject to
  \begin{gather}
    \lambda_k \ge 0
    \quad
    \text{for all}\ 
    k \in \left\{ 1, \ldots, K \right\}
    ,
  \end{gather}
  where
  \begin{gather}
    \mathbf{Q}
    :=
    \begin{bmatrix}
      \mathbf{I}_n\\
      \mathbf{B}(\mathbf{X})\\
      -\mathbf{B}(\mathbf{X})
    \end{bmatrix}
    ,
    \qquad
    \mathbf{B}(\mathbf{X})
    :=
    \begin{bmatrix}
      B(X_1), \ldots, B(X_n)
    \end{bmatrix}
    ,
    \qquad
    \text{and}
    \qquad
    d
    :=
    \begin{bmatrix}
      0_n\\
      \delta \\
      \delta
    \end{bmatrix}
    .
  \end{gather}

  \end{lemma}

\end{proof}
