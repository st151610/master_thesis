
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\begin{theorem}
  \emph{(Multivariate Taylor Theorem)}
  Let 
  $f \in C^2(\R^n, \R)$.
  Then 
  for all $x, \Delta \in \R^n$
  there exists $\xi \in [0,1]$
  such that 
  it holds
  \begin{align}
    \label{syu_taylor}
    \begin{split}
    f(x + \Delta)
    &=
    f(x)
    +
    \sum_{i = 1}^{n} \frac{\partial f(x)}{\partial x_i} \Delta_i    
    + 
    \sum_{
    \begin{smallmatrix}
      i,j = 1 \\ 
      i \neq j
    \end{smallmatrix}
    }
    \frac{\partial^2 f(x + \xi \Delta)}{\partial x_i \partial x_j} \Delta_i\Delta_j
    \\
    & \quad+ 
    \frac{1}{2}\sum_{i = 1}^{n} \frac{\partial^2 f(x + \xi \Delta)}{\partial x_i^2}\Delta_i^2 
    \end{split}
  \end{align}
\end{theorem}


\begin{corollary}
  \label{syu_taylor_corollary}
  Let 
  $f\in C^2(\R)$. 
  Then
  for all $a,x,\Delta \in \R^n$ 
  there exist $\xi \in [0,1]$ 
  such that it holds
  \begin{gather}
    \label{syu_2.result}
    f(a^T (x + \Delta)) - f(a^T x) = 
    f^{'}(a^T x)\, \Delta^T a + 
    \frac{1}{2}f^{''}(a^T (x + \xi \Delta))\, \Delta^T A\ \Delta,
  \end{gather}
  where 
  $A:= a a^T \in \R^{n \times n}$.
\end{corollary}

\begin{proof}
  By the chain rule 
  we have
  for all $a, x, \Delta \in \R^n$ and $\xi \in [0,1]$
  \begin{gather}
    \label{syu_2.0}
    \frac{\partial^2  f(a^T (x + \xi \Delta)) }{\partial x_i \partial x_j}
    =
    f^{''}(a^T (x + \xi \Delta))\, a_i a_j
    .
  \end{gather}
  Since 
  $A:= a a^T$ is symmetric
  we have
  \begin{gather}
    \label{syu_2.1}
    \Delta^T A\ \Delta 
    =
    2
    \sum_{
    \begin{smallmatrix}
      i,j = 1 \\ 
      i \neq j
    \end{smallmatrix}
    }
    ^{n}
    a_i a_j \Delta_i \Delta_j
    + 
    \sum_{i=1}^{n} 
    a_i^2 \Delta_i^2.
  \end{gather}
  Plugging \eqref{syu_2.0} and \eqref{syu_2.1} into \eqref{syu_taylor}
  yields
  \eqref{syu_2.result}.
\end{proof}

\begin{proposition}
  \label{syu_triangle}
  For all 
  $x, y \in \R$ 
  it holds
  \begin{gather}
    |x + y| - |x| \ge -|y|
  \end{gather}
\end{proposition}

\begin{proof}
  Checking all 6 combinations of
  $x + y, x, y$ 
  being nonnegative or negative 
  yields the result.
\end{proof}
