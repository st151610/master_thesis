Before we proof the theorem, we proof some lemmas that are useful in the next section.


\begin{assumption}
  \label{sol_theta}
  There exists $\underline{N}\in\mathbb{N}$ such that 
  for all $N\ge \underline{N}$ and for all data sets $D_N$
  the optimal solution
  $(\lambda^\dagger,\lambda_0^\dagger)$
  to Problem? exists in a (compact) parameter space 
  $\Theta_N\subset \R^{N+1}$, containing the origin, with
  $\mathrm{diam}\,\Theta_N<\infty$.
\end{assumption}

\begin{assumption}
  \label{objective_function}
  The objective function $f$ to Problem? is strictly convex, with strictly convex and continuously differentiable convex conjugate $f^*$. 
\end{assumption}
\begin{definition}
  We define the weight function to be
\begin{gather*}
  w
  \colon
  \mathcal{X}
  \times
  \R^{N+1}
  \to
  \R
  ,\qquad
  \left( 
  x
  ,
  \lambda
  ,
  \lambda_0
  \right)
  \mapsto
    (
    f^{'}
    )^{-1}
    \left( 
      \inner{B(x)}{\lambda^\dagger}
      +
      \lambda_0^\dagger
    \right)
    \,.
\end{gather*}
If 
  the optimal solution
  $(\lambda^\dagger,\lambda_0^\dagger)$
  to Problem ? exists, we write
  \begin{gather*}
    w^\dagger(x)
    =
    w(x,\lambda^\dagger,\lambda^\dagger_0)
    \qquad
    \text{for all}\ 
    x\in\mathcal{X}\,.
  \end{gather*}
\end{definition}
\begin{remark}
  The (optimal) weight function $w^\dagger$ depends on the data
  $D_N:=
  (T_i,X_i)_{i\in \left\{ 1,\ldots,N \right\}}$
  and the partition $\mathcal{P}_N$.
\end{remark}
\begin{lemma}
  \label{weights_bounded}
  Let Assumption~\ref{sol_theta} and Assumption~\ref{objective_function} hold true.
  Then it holds 
  $
  w^\dagger(X)\in L^\infty(\P)
  $ for all $N\ge \underline{N}$.
\end{lemma}
\begin{proof}
  Let $N\ge \underline{N}$.
  $
    \text{For all}\ 
    x\in\mathcal{X}
    \
    \text{and for all}\ 
    (\lambda,\lambda_0)\in \R^{N+1}
  $ it holds
  \begin{gather*}
    \left| 
    \inner{B(x)}{\lambda}
    +
    \lambda_0
    \right|
    \ 
    \le
    \ 
    \norm{(B(x),1)}_2
    \norm{(\lambda,\lambda_0)}_2
    \ 
    \le
    \ 
    2
    \norm{(\lambda,\lambda_0)}_2
    \,.
  \end{gather*}
  By Assumption~\ref{sol_theta}, 
  there exists a (compact) parameter space
  $\Theta_N$ around the origin, with $\mathrm{diam}\,  \Theta_N<\infty$, 
  such that for all data sets $D_N$ it holds  $(\lambda^\dagger,\lambda_0^\dagger)\in\Theta_N$.
  By Assumption~\ref{objective_function}, $(f^{'})^{-1}$ is non-decreasing and continuous. Thus
  \begin{align*}
    \left| 
    w^\dagger(x)
    \right|
    &
    \ 
    \le
    \ 
    \left| 
    (f^{'})^{-1}
    \left( 
      -2
      \norm{(\lambda^\dagger,\lambda^\dagger_0)}_2
    \right)
    \right|
    +
    \left| 
    (f^{'})^{-1}
    \left( 
      2
      \norm{(\lambda^\dagger,\lambda^\dagger_0)}_2
    \right)
    \right|
    \\
    &
    \ 
    \le
    \ 
    \left| 
    (f^{'})^{-1}
    \left( 
      -2
      \mathrm{diam}\,\Theta_N
    \right)
    \right|
    +
    \left| 
    (f^{'})^{-1}
    \left( 
      2
      \mathrm{diam}\,\Theta_N
    \right)
    \right|
    +
    2
    \left| 
    (f^{'})^{-1}
    \left( 
      0
    \right)
    \right|
    \ 
    <
    \ 
    \infty
  \end{align*}
  for all $x\in\mathcal{X}$.
\end{proof}
\begin{lemma}
  Let Assumption~\ref{sol_theta} and Assumption~\ref{objective_function} hold true.
  Furthermore, 
  let
  $N\ge\underline{N}$, and
  let
  $Z\in L^1(\P)$
  be a random variable that is independent of $D_N$ 
  with
  $
\E
\left[
  Z
  \,
  |
  \, 
  X
\right]
= 0
  $
  almost surely.
  It holds
  $
  \E
  \left[
  w^\dagger(X)\cdot Z
  \right]
  =0
  $.
\end{lemma}
\begin{proof}
  Let
  $N\ge\underline{N}$.
  By Lemma~\ref{weights_bounded} and 
  $Z\in L^1(\P)$
  it holds
  \begin{gather}
    \label{6879}
  \E
  \left|
  w^\dagger(X)\cdot Z
  \right|
  \le
  \norm{w^\dagger(X)}_{L^\infty(\P)}
  \norm{Z}_{L^1(\P)}
  <\infty
  \,.
  \end{gather}
  By 
  \eqref{6879},
  $Z\perp D_N$
  and
  $
\E
\left[
  Z
  \,
  |
  \, 
  X
\right]
= 0
  $
  almost surely
  it holds 
  \begin{gather*}
    \E
  \left[
  w^\dagger(X)
  \cdot
  Z
  \,
  |
  \,
  D_N,X
  \right]
  \ 
  =
  \ 
  w^\dagger(X)
  \cdot
  \E
  \left[
  Z
  \,
  |
  \,
  D_N,X
  \right]
  \ 
  =
  \ 
  w^\dagger(X)
  \cdot
  \E
  \left[
  Z
  \,
  |
  \,
  X
  \right]
  \
  =
  \ 
  0
  \end{gather*}
  almost surely.
  Thus
  \begin{gather*}
    \E
    \left[
  w^\dagger(X)
  \cdot
  Z
  \,
    \right]
    \ 
    =
    \ 
    \E
    \left[
 \E
  \left[
  w^\dagger(X)
  \cdot
  Z
  \,
  |
  \,
  D_N,X
  \right]
    \right]
    \ 
    =
    \ 
    0
    \,.
     \end{gather*}
\end{proof}
\begin{ftheorem}
  \label{aa:weights:th}
  Let Assumption~\ref{sol_theta} hold true.
  Under the conditions of Proposition~\ref{bw:cd:th} 
  it holds
  $w^\dagger(X)\ 
  \overset{\P}{\to}
  \ 
  1/\pi(X)
  $
  .
  Furthmore, there exists a decreasing sequence $(\varepsilon_N)\subset(0,1]$ such that $\varepsilon_N\to 0$ and 
  \begin{gather}
    \P
    \left[ 
  \left| 
  w^\dagger(X)
  -
  \frac{1}{\pi(X)}
  \right|
    \le
    \varepsilon_N
    \right]
  \  
  \to
  \  
  0
  \qquad
  \text{for}
  \ 
  N\to\infty
  \,.
  \end{gather}
\end{ftheorem}
\begin{proof}
  Let
  $N\ge\underline{N}$.
  For all $\varepsilon>0$ it holds
\begin{align}
  \begin{split}
  \left| 
  w^\dagger(X)
  -
  \frac{1}{\pi(X)}
  \right|
  &
  \ 
  =
  \ 
  \left| 
  (f^{'})^{-1}
  \left( 
    \inner{B(X)}
    {\lambda^\dagger}
    +
    \lambda_0^\dagger
  \right)
  -
  \frac{1}{\pi(X)}
  \right|
  \\
  &
  \ 
  \lesssim
  \ 
  \left| 
    \inner{(B(X),1)}
    {
      (\lambda^\dagger,\lambda_0^\dagger)
      -
      (\lambda^*,0)
    }
  \right|
  +
  \left| 
    \inner{B(X)}
    {
      \lambda^*
      }
    -
    f^{'}
    \left( 
  \frac{1}{\pi(X)}
    \right)
  \right|
  \\
  &
  \ 
  \lesssim
  \ 
  \norm{
      (\lambda^\dagger,\lambda_0^\dagger)
      -
      (\lambda^*,0)
}_2
  +
  \left| 
  \sum_{i=1}^{N} 
  B_k(X)
  \cdot
    f^{'}
    \left( 
  \frac{1}{\pi(X_k)}
    \right)
    -
    f^{'}
    \left( 
  \frac{1}{\pi(X)}
    \right)
  \right|
  \\
  &
  \ 
  \le
  \ 
  \frac{\varepsilon}{2}
+
  \frac{\varepsilon}{2}
  \le
  \varepsilon
  \,,
\end{split}
\end{align}
with probability going to $1$ as $N\to\infty$.
The convergence of the first term follows from Proposition~\ref{bw:cd:th} and that of the second term from \eqref{part_trick}.
The second statement of the theorem follows from the Selection lemma
\cite[A.1.4.]{Steinwart2008}.
\end{proof}
